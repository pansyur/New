version: v1.0
name: Torrent Download and Upload
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu2004
blocks:
  - name: Install Dependencies
    task:
      jobs:
        - name: Install webtorrent-cli
          commands:
            - apt install aria2 -y
  - name: Download Torrent
    task:
      jobs:
        - name: Download Files
          commands:
            - echo "Creating download directory..."
            - mkdir -p ~/downloaded_files
            - echo "Starting torrent download..."
            - >-
              aria2c --seed-time=0
              "magnet:?xt=urn:btih:8253f79dc1c2bd8d266c4c0d46299458cb50be02&dn=KPop+Demon+Hunters+2025+1080p+NF+WEB-DL+DDP5+1+Atmos+H+264-FLUX%20%20%20%20%20%20%20%20&tr=udp://tracker.bittor.pw:1337/announce%20%20%20%20%20%20%20%20&tr=udp://tracker.opentrackr.org:1337/announce%20%20%20%20%20%20%20%20&tr=udp://tracker.dler.org:6969/announce%20%20%20%20%20%20%20%20&tr=udp://open.stealth.si:80/announce%20%20%20%20%20%20%20%20&tr=udp://tracker.torrent.eu.org:451/announce%20%20%20%20%20%20%20%20&tr=udp://exodus.desync.com:6969/announce%20%20%20%20%20%20%20%20&tr=udp://open.demonii.com:1337/announce"
              -d ~/downloaded_files
            - echo "Listing files after download..."
            - ls -l ~/downloaded_files
            - 'if [ "$(ls -A ~/downloaded_files)" ]; then echo "Download successful."; else echo "No files downloaded. Check magnet link or seeders."; exit 1; fi'
  - name: Upload Files to Filebin
    task:
      jobs:
        - name: Upload Files
          commands:
            - BIN_NAME="fn5l2fc0lh3bplas"
            - 'for file in ~/downloaded_files/*; do filename=$(basename "$file") echo "Uploading $filename..." response=$(curl -s -w "%{http_code}" --data-binary @"$file" "https://filebin.net/$BIN_NAME/$filename") http_code=$(echo "$response" | tail -n1) if [ "$http_code" != "200" ]; then echo "Failed to upload $filename" else echo "$filename uploaded successfully." fi done'
